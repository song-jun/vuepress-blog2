import{_ as e,o,c,a as n,b as a,e as t,d as p,r as i}from"./app.edc3ba14.js";const l={},u=t(`<div class="custom-container tip"><p class="custom-container-title">Python</p><p>pip\u955C\u50CF\u4E0B\u8F7D\u6A21\u5757<br> python\u542F\u52A8\u672C\u5730\u670D\u52A1<br> python3\u57FA\u7840\u8BED\u6CD5<br> python \u5199api\u63A5\u53E3<br> ......</p></div><h2 id="pip\u955C\u50CF\u4E0B\u8F7D\u6A21\u5757" tabindex="-1"><a class="header-anchor" href="#pip\u955C\u50CF\u4E0B\u8F7D\u6A21\u5757" aria-hidden="true">#</a> pip\u955C\u50CF\u4E0B\u8F7D\u6A21\u5757</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>pip <span class="token function">install</span> -i https://pypi.tuna.tsinghua.edu.cn/simple name
<span class="token comment"># \u5E38\u7528\u955C\u50CF</span>
<span class="token comment"># \u8C46\u74E3\uFF1Ahttps://pypi.douban.com/simple</span>
<span class="token comment"># \u963F\u91CC\uFF1Ahttps://mirrors.aliyun.com/pypi/simple</span>
<span class="token comment"># \u6E05\u534E\uFF1Ahttps://pypi.tuna.tsinghua.edu.cn/simple</span>
<span class="token comment"># name\u5C31\u662F\u8981\u5B89\u88C5\u7684\u5305\u7684\u540D\u5B57</span>
<span class="token comment"># eg:</span>

pip <span class="token function">install</span> -i https://pypi.tuna.tsinghua.edu.cn/simple xgboost

<span class="token comment"># \u6C38\u4E45\u4FEE\u6539\uFF0C\u4E00\u52B3\u6C38\u9038\uFF1A</span>
<span class="token comment"># Linux\u4E0B\uFF0C\u4FEE\u6539 ~/.pip/pip.conf (\u6CA1\u6709\u5C31\u521B\u5EFA\u4E00\u4E2A\u6587\u4EF6\u5939\u53CA\u6587\u4EF6\u3002\u6587\u4EF6\u5939\u8981\u52A0\u201C.\u201D\uFF0C\u8868\u793A\u662F\u9690\u85CF\u6587\u4EF6\u5939)</span>

<span class="token comment"># \u5185\u5BB9\u5982\u4E0B\uFF1A</span>

<span class="token punctuation">[</span>global<span class="token punctuation">]</span>
index-url <span class="token operator">=</span> https://pypi.tuna.tsinghua.edu.cn/simple
<span class="token punctuation">[</span>install<span class="token punctuation">]</span>
trusted-host<span class="token operator">=</span>mirrors.aliyun.com
<span class="token comment"># windows\u4E0B\uFF0C\u76F4\u63A5\u5728user\u76EE\u5F55\u4E2D\u521B\u5EFA\u4E00\u4E2Apip\u76EE\u5F55\uFF0C\u5982\uFF1AC:\\Users\\xx\\pip\uFF0C\u65B0\u5EFA\u6587\u4EF6pip.ini\u3002\u5185\u5BB9\u540C\u4E0A\u3002</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="python\u542F\u52A8\u672C\u5730\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#python\u542F\u52A8\u672C\u5730\u670D\u52A1" aria-hidden="true">#</a> python\u542F\u52A8\u672C\u5730\u670D\u52A1</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>python <span class="token operator">-</span>m http<span class="token punctuation">.</span>server <span class="token number">8123</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="python3\u57FA\u7840\u8BED\u6CD5" tabindex="-1"><a class="header-anchor" href="#python3\u57FA\u7840\u8BED\u6CD5" aria-hidden="true">#</a> python3\u57FA\u7840\u8BED\u6CD5</h2>`,6),r={href:"https://www.runoob.com/python3/python3-tutorial.html",target:"_blank",rel:"noopener noreferrer"},k=p("\u83DC\u9E1F\u6559\u7A0B"),d={href:"https://www.w3school.com.cn/python/python_examples.asp",target:"_blank",rel:"noopener noreferrer"},v=p("w3school"),m=t(`<h2 id="scrapy\u6846\u67B6" tabindex="-1"><a class="header-anchor" href="#scrapy\u6846\u67B6" aria-hidden="true">#</a> scrapy\u6846\u67B6</h2><p>\u5B89\u88C5</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>pip <span class="token function">install</span> scrapy
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="python-\u5199api\u63A5\u53E3" tabindex="-1"><a class="header-anchor" href="#python-\u5199api\u63A5\u53E3" aria-hidden="true">#</a> python \u5199api\u63A5\u53E3</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&#39;&#39;&#39;
@Description: 
@Version: 
@Autor: MrSong
@Date: 2020-07-05 11:46:38
@LastEditors: MrSong
@LastEditTime: 2020-07-05 11:55:30
&#39;&#39;&#39;</span>
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> jsonify

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&#39;/testGet&#39;</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">calculateGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    a <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    b <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    c <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">int</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
    res <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">:</span> c<span class="token punctuation">}</span>
    <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span>content_type<span class="token operator">=</span><span class="token string">&#39;application/json;charset=utf-8&#39;</span><span class="token punctuation">,</span>
                   reason<span class="token operator">=</span><span class="token string">&#39;success&#39;</span><span class="token punctuation">,</span>
                   charset<span class="token operator">=</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">,</span>
                   status<span class="token operator">=</span><span class="token string">&#39;200&#39;</span><span class="token punctuation">,</span>
                   content<span class="token operator">=</span>res<span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&#39;/testPost&#39;</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;POST&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">calculatePost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    params <span class="token operator">=</span> request<span class="token punctuation">.</span>form <span class="token keyword">if</span> request<span class="token punctuation">.</span>form <span class="token keyword">else</span> request<span class="token punctuation">.</span>json
    <span class="token keyword">print</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
    a <span class="token operator">=</span> params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    b <span class="token operator">=</span> params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    c <span class="token operator">=</span> a <span class="token operator">+</span> b
    res <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">:</span> c<span class="token punctuation">}</span>
    <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span>content_type<span class="token operator">=</span><span class="token string">&#39;application/json;charset=utf-8&#39;</span><span class="token punctuation">,</span>
                   reason<span class="token operator">=</span><span class="token string">&#39;success&#39;</span><span class="token punctuation">,</span>
                   charset<span class="token operator">=</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">,</span>
                   status<span class="token operator">=</span><span class="token string">&#39;200&#39;</span><span class="token punctuation">,</span>
                   content<span class="token operator">=</span>res<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">&#39;0.0.0.0&#39;</span><span class="token punctuation">,</span> threaded<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8070</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u94FE\u63A5mysql" tabindex="-1"><a class="header-anchor" href="#\u94FE\u63A5mysql" aria-hidden="true">#</a> \u94FE\u63A5mysql</h2><p>\u6E90\u7801\u5C55\u793A</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&#39;&#39;&#39;
@Description: 
@Version: 
@Autor: MrSong
@Date: 2020-07-04 13:28:26
@LastEditors: MrSong
@LastEditTime: 2020-07-04 20:31:50
&#39;&#39;&#39;</span>
<span class="token keyword">import</span> mysql<span class="token punctuation">.</span>connector
db <span class="token operator">=</span> mysql<span class="token punctuation">.</span>connector<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">&quot;ip\u5730\u5740&quot;</span><span class="token punctuation">,</span>
                             user<span class="token operator">=</span><span class="token string">&quot;\u7528\u6237\u540D&quot;</span><span class="token punctuation">,</span>
                             passwd<span class="token operator">=</span><span class="token string">&quot;\u5BC6\u7801&quot;</span><span class="token punctuation">,</span>
                             database<span class="token operator">=</span><span class="token string">&quot;\u6570\u636E\u5E93&quot;</span><span class="token punctuation">)</span>
cursor <span class="token operator">=</span> db<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;SELECT * FROM test&quot;</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>


<span class="token comment"># \u5199\u5165\u6570\u636E\u5E93</span>
<span class="token keyword">def</span> <span class="token function">write_db</span><span class="token punctuation">(</span>chapter<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">&quot;INSERT INTO test (id, time) VALUES(%(id)s, %(time)s);&quot;</span>
    param <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> chapter<span class="token punctuation">,</span> <span class="token string">&quot;time&quot;</span><span class="token punctuation">:</span> content<span class="token punctuation">}</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> param<span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;SELECT * FROM test&quot;</span><span class="token punctuation">)</span>
    data <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    write_db<span class="token punctuation">(</span><span class="token number">8811</span><span class="token punctuation">,</span> <span class="token number">555554441188</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
    write_db<span class="token punctuation">(</span><span class="token number">12811</span><span class="token punctuation">,</span> <span class="token number">555554442200</span><span class="token punctuation">)</span>
    db<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u6570\u636E\u5BFC\u51FAexcel\u8868\u683C" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u5BFC\u51FAexcel\u8868\u683C" aria-hidden="true">#</a> \u6570\u636E\u5BFC\u51FAexcel\u8868\u683C</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> pymysql
<span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> xlwt
<span class="token keyword">import</span> os

<span class="token keyword">def</span> <span class="token function">op_mysql</span><span class="token punctuation">(</span>sql<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    mysql_info <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&#39;host&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;ip\u5730\u5740&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;port&#39;</span><span class="token punctuation">:</span> <span class="token number">3306</span><span class="token punctuation">,</span>
        <span class="token string">&#39;password&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;\u5BC6\u7801&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;user&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;\u7528\u6237\u540D&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;db&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;\u6570\u636E\u5E93&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;charset&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;utf8&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;autocommit&#39;</span><span class="token punctuation">:</span> <span class="token boolean">True</span>
    <span class="token punctuation">}</span>
    result <span class="token operator">=</span> <span class="token string">&#39;\u6267\u884C\u5B8C\u6210&#39;</span>
    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token operator">**</span>mysql_info<span class="token punctuation">)</span>
    <span class="token comment"># cur = conn.cursor(pymysql.cursors.DictCursor) #\u5EFA\u7ACB\u6E38\u6807</span>
    cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># \u5EFA\u7ACB\u6E38\u6807</span>
    cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    field <span class="token operator">=</span> <span class="token punctuation">[</span>t<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> t <span class="token keyword">in</span> cur<span class="token punctuation">.</span>description<span class="token punctuation">]</span>  <span class="token comment"># \u83B7\u53D6\u8868\u91CC\u9762\u7684\u6240\u6709\u5B57\u6BB5\u540D</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span>
    <span class="token keyword">if</span> sql<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">&#39;select&#39;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># result  = cur.fetchone()</span>
        result <span class="token operator">=</span> cur<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cur<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;\u6240\u6709\u7684\u5B57\u6BB5&#39;</span><span class="token punctuation">,</span> field<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;\u6240\u6709\u7684\u6570\u636E&#39;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
    result <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>  <span class="token comment"># \u56E0\u4E3A\u8FD4\u56DE\u7684\u662F\u5143\u7EC4\uFF0C\u4E0D\u80FD\u4FEE\u6539\uFF0C\u6240\u4EE5\u8F6C\u6210list</span>
    result<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> field<span class="token punctuation">)</span>  <span class="token comment"># \u52A0\u5165\u5230\u6700\u524D\u9762</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    <span class="token keyword">return</span> result


<span class="token keyword">def</span> <span class="token function">export_excel</span><span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">&#39;select * from %s;&#39;</span> <span class="token operator">%</span> table_name
    result <span class="token operator">=</span> op_mysql<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    book <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sheet <span class="token operator">=</span> book<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">&#39;sheet&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> row<span class="token punctuation">,</span> line <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> col<span class="token punctuation">,</span> t <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">:</span>
            sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">,</span> t<span class="token punctuation">)</span>
    createFile<span class="token punctuation">(</span><span class="token string">&quot;E:\\pythonExport&quot;</span><span class="token punctuation">)</span>
    book<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;%s.xls&#39;</span> <span class="token operator">%</span> table_name<span class="token punctuation">)</span>


<span class="token comment"># \u521B\u5EFA\u6587\u4EF6\u5939</span>
<span class="token keyword">def</span> <span class="token function">createFile</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token boolean">False</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
    <span class="token comment"># \u5207\u6362\u8DEF\u5F84\u81F3\u4E0A\u9762\u521B\u5EFA\u7684\u6587\u4EF6\u5939</span>
    os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>


export_excel<span class="token punctuation">(</span><span class="token string">&#39;test&#39;</span><span class="token punctuation">)</span>

book <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
sheet <span class="token operator">=</span> book<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">&#39;sheet&#39;</span><span class="token punctuation">)</span>
l <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token string">&#39;dsk&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;xxdfsdfsd&#39;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;ldd&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;xxdfsdfsd&#39;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;lsdd&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;xxdfsdfsd&#39;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&#39;lsd1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;xxdfsdfsd&#39;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment"># \u65B9\u6CD5\u4E00\uFF1A</span>
<span class="token comment"># row = 0#\u884C\u53F7</span>
<span class="token comment"># for line in l: #\u5916\u9762\u8FD9\u4E2A\u5FAA\u73AF\uFF0C\u6BCF\u5FAA\u73AF\u4E00\u6B21\uFF0C\u5C31\u5199excel\u91CC\u9762\u4E00\u884C</span>
<span class="token comment">#     # col = 0#\u5217\u53F7   [1,&#39;dsk&#39;,&#39;xxdfsdfsd&#39;,0]</span>
<span class="token comment">#     col = 0</span>
<span class="token comment">#     for t in line:#\u91CC\u9762\u8FD9\u4E2A\u5FAA\u73AF\u662F\u63A7\u5236\u5217\u7684\uFF0C\u6BCF\u5FAA\u73AF\u4E00\u6B21\u5C31\u5199\u4E00\u5217</span>
<span class="token comment">#         sheet.write(row,col,t)</span>
<span class="token comment">#         col+=1</span>
<span class="token comment">#     row+=1</span>
<span class="token comment">#</span>

<span class="token comment"># \u65B9\u6CD5\u4E8C\uFF1A</span>
<span class="token keyword">for</span> row<span class="token punctuation">,</span> line <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> col<span class="token punctuation">,</span> t <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">:</span>
        sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">,</span> t<span class="token punctuation">)</span>
createFile<span class="token punctuation">(</span><span class="token string">&quot;E:\\pythonExportTest&quot;</span><span class="token punctuation">)</span>
book<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;user.xls&#39;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="excel\u8868\u683C\u6570\u636E\u5BFC\u5165mysql" tabindex="-1"><a class="header-anchor" href="#excel\u8868\u683C\u6570\u636E\u5BFC\u5165mysql" aria-hidden="true">#</a> excel\u8868\u683C\u6570\u636E\u5BFC\u5165mysql</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&#39;&#39;&#39;
@Description: 
@Version: 
@Autor: MrSong
@Date: 2020-07-04 20:54:03
@LastEditors: MrSong
@LastEditTime: 2020-07-04 21:18:29
&#39;&#39;&#39;</span>
<span class="token keyword">import</span> pymysql
<span class="token comment"># xlrd \u4E3A python \u4E2D\u8BFB\u53D6 excel \u7684\u5E93\uFF0C\u652F\u6301.xls \u548C .xlsx \u6587\u4EF6</span>
<span class="token keyword">import</span> xlrd

<span class="token keyword">from</span> builtins <span class="token keyword">import</span> <span class="token builtin">int</span>


<span class="token comment"># cur \u662F\u6570\u636E\u5E93\u7684\u6E38\u6807\u94FE\u63A5\uFF0Cpath \u662F excel \u6587\u4EF6\u7684\u8DEF\u5F84</span>
<span class="token keyword">def</span> <span class="token function">importExcelToMysql</span><span class="token punctuation">(</span>cur<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment"># xlrd\u7248\u672C</span>
    <span class="token comment"># \u8BFB\u53D6excel\u6587\u4EF6</span>
    workbook <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    sheets <span class="token operator">=</span> workbook<span class="token punctuation">.</span>sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span>
    worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span>sheets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token comment"># xlrd\u7248\u672C</span>
    <span class="token comment"># \u5C06\u8868\u4E2D\u6570\u636E\u8BFB\u5230 sqlstr \u6570\u7EC4\u4E2D</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> worksheet<span class="token punctuation">.</span>nrows<span class="token punctuation">)</span><span class="token punctuation">:</span>
        row <span class="token operator">=</span> worksheet<span class="token punctuation">.</span>row<span class="token punctuation">(</span>i<span class="token punctuation">)</span>

        sqlstr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> worksheet<span class="token punctuation">.</span>ncols<span class="token punctuation">)</span><span class="token punctuation">:</span>
            sqlstr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span>cell_value<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>sqlstr<span class="token punctuation">)</span>
        cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>
            <span class="token string">&quot;insert into student(\u59D3\u540D, \u8BED\u6587, \u6570\u5B66, \u82F1\u8BED) values(%s, %s, %s, %s)&quot;</span><span class="token punctuation">,</span>
            sqlstr<span class="token punctuation">)</span>


<span class="token comment"># \u8F93\u51FA\u6570\u636E\u5E93\u4E2D\u5185\u5BB9</span>
<span class="token keyword">def</span> <span class="token function">readTable</span><span class="token punctuation">(</span>cursor<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># \u9009\u62E9\u5168\u90E8</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;select * from student&quot;</span><span class="token punctuation">)</span>
    <span class="token comment"># \u83B7\u5F97\u8FD4\u56DE\u503C\uFF0C\u8FD4\u56DE\u591A\u6761\u8BB0\u5F55\uFF0C\u82E5\u6CA1\u6709\u7ED3\u679C\u5219\u8FD4\u56DE()</span>
    results <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> results<span class="token punctuation">.</span>__len__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>results<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&#39;\\t&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;\\n&#39;</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    <span class="token comment"># \u548C\u6570\u636E\u5E93\u5EFA\u7ACB\u8FDE\u63A5</span>
    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">&#39;ip\u5730\u5740&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;\u7528\u6237\u540D&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;\u5BC6\u7801&#39;</span><span class="token punctuation">,</span> charset<span class="token operator">=</span><span class="token string">&#39;utf8&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># \u521B\u5EFA\u6E38\u6807\u94FE\u63A5</span>
    cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># \u65B0\u5EFA\u4E00\u4E2Adatabase</span>
    cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;drop database if exists students&quot;</span><span class="token punctuation">)</span>
    cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;create database students&quot;</span><span class="token punctuation">)</span>
    <span class="token comment"># \u9009\u62E9 students \u8FD9\u4E2A\u6570\u636E\u5E93</span>
    cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;use students&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># sql\u4E2D\u7684\u5185\u5BB9\u4E3A\u521B\u5EFA\u4E00\u4E2A\u540D\u4E3Astudent\u7684\u8868</span>
    sql <span class="token operator">=</span> <span class="token triple-quoted-string string">&quot;&quot;&quot;CREATE TABLE IF NOT EXISTS \`student\` (
                \`\u59D3\u540D\` VARCHAR (20),
                \`\u8BED\u6587\` INT,
                \`\u6570\u5B66\` INT,
                \`\u82F1\u8BED\` INT
              )&quot;&quot;&quot;</span>
    <span class="token comment"># \u5982\u679C\u5B58\u5728student\u8FD9\u4E2A\u8868\u5219\u5220\u9664</span>
    cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;drop table if exists student&quot;</span><span class="token punctuation">)</span>
    <span class="token comment"># \u521B\u5EFA\u8868</span>
    cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>

    <span class="token comment"># \u5C06 excel \u4E2D\u7684\u6570\u636E\u5BFC\u5165 \u6570\u636E\u5E93\u4E2D</span>
    importExcelToMysql<span class="token punctuation">(</span>cur<span class="token punctuation">,</span> <span class="token string">&quot;../student.xls&quot;</span><span class="token punctuation">)</span>
    readTable<span class="token punctuation">(</span>cur<span class="token punctuation">)</span>

    <span class="token comment"># \u5173\u95ED\u6E38\u6807\u94FE\u63A5</span>
    cur<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># \u5173\u95ED\u6570\u636E\u5E93\u670D\u52A1\u5668\u8FDE\u63A5\uFF0C\u91CA\u653E\u5185\u5B58</span>
    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u6570\u636E\u5BFC\u51FAtxt\u6587\u6863" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u5BFC\u51FAtxt\u6587\u6863" aria-hidden="true">#</a> \u6570\u636E\u5BFC\u51FAtxt\u6587\u6863</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&#39;&#39;&#39;
@Description: 
@Version: 
@Autor: MrSong
@Date: 2020-07-04 19:42:36
@LastEditors: MrSong
@LastEditTime: 2020-07-04 20:45:17
&#39;&#39;&#39;</span>
<span class="token comment">#/usr/bin/python</span>
<span class="token keyword">import</span> os
<span class="token keyword">import</span> datetime
<span class="token keyword">import</span> time
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> importlib
importlib<span class="token punctuation">.</span><span class="token builtin">reload</span><span class="token punctuation">(</span>sys<span class="token punctuation">)</span>
<span class="token keyword">import</span> pymysql


<span class="token keyword">def</span> <span class="token function">op_mysql</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">:</span>
    t <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;begin:&quot;</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        str_time <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        y <span class="token operator">=</span> t<span class="token punctuation">.</span>year
        m <span class="token operator">=</span> t<span class="token punctuation">.</span>month
        d <span class="token operator">=</span> t<span class="token punctuation">.</span>day
        str_time <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
    <span class="token comment"># print(str_time.strftime(&#39;%Y-%m-%d %H:%M:%S.%f&#39;))</span>
    mysql_info <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&#39;host&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;ip\u5730\u5740&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;port&#39;</span><span class="token punctuation">:</span> <span class="token number">3306</span><span class="token punctuation">,</span>
        <span class="token string">&#39;password&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;\u5BC6\u7801&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;user&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;\u7528\u6237\u540D&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;db&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;\u6570\u636E\u5E93&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;charset&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;utf8&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;autocommit&#39;</span><span class="token punctuation">:</span> <span class="token boolean">True</span>
    <span class="token punctuation">}</span>
    result <span class="token operator">=</span> <span class="token string">&#39;\u6267\u884C\u5B8C\u6210&#39;</span>
    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token operator">**</span>mysql_info<span class="token punctuation">)</span>
    <span class="token comment"># cur = conn.cursor(pymysql.cursors.DictCursor) #\u5EFA\u7ACB\u6E38\u6807</span>
    cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># \u5EFA\u7ACB\u6E38\u6807</span>
    cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        rows <span class="token operator">=</span> cur<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span>
        field <span class="token operator">=</span> <span class="token punctuation">[</span>t<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> t <span class="token keyword">in</span> cur<span class="token punctuation">.</span>description<span class="token punctuation">]</span>
        rows <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span>
        rows<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> field<span class="token punctuation">)</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;record.txt&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;w&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fout<span class="token punctuation">:</span>
            <span class="token comment">#print &gt;&gt;fout, rows</span>
            <span class="token keyword">for</span> row <span class="token keyword">in</span> rows<span class="token punctuation">:</span>
                t <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                fout<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">&#39;%s,%s\\n&#39;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>t<span class="token punctuation">,</span> row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> <span class="token punctuation">(</span>ValueError<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\u53C2\u6570\u6CA1\u6709\u5305\u542B\u6570\u5B57\\n&quot;</span><span class="token punctuation">,</span> ValueError<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">&quot;SELECT * FROM test;&quot;</span>
    op_mysql<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="python\u4E0B\u8F7D\u817E\u8BAF-\u7231\u5947\u827A-\u4F18\u9177-\u571F\u8C46vip\u89C6\u9891" tabindex="-1"><a class="header-anchor" href="#python\u4E0B\u8F7D\u817E\u8BAF-\u7231\u5947\u827A-\u4F18\u9177-\u571F\u8C46vip\u89C6\u9891" aria-hidden="true">#</a> python\u4E0B\u8F7D\u817E\u8BAF\uFF0C\u7231\u5947\u827A\uFF0C\u4F18\u9177\uFF0C\u571F\u8C46vip\u89C6\u9891</h2><ul><li>\u656C\u8BF7\u671F\u5F85\uFF0C\u66F4\u65B0\u4E2D</li></ul>`,16);function b(h,y){const s=i("ExternalLinkIcon");return o(),c("div",null,[u,n("ul",null,[n("li",null,[n("p",null,[n("a",r,[k,a(s)])])]),n("li",null,[n("p",null,[n("a",d,[v,a(s)])])])]),m])}var w=e(l,[["render",b],["__file","python.html.vue"]]);export{w as default};
